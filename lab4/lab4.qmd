---
title: "Практика 4"
author: "Гренкова Анна БИСО-01-20"
format: 
  md:
    output-file: README.md
---

### Цель работы

1. Зекрепить практические навыки использования языка программирования R для обработки данных
2. Закрепить знания основных функций обработки данных экосистемы tidyverse языка R
3. Закрепить навыки исследования метаданных DNS трафика

## Исходные данные

1. ОС Windows 11
2. RStudio Desktop
3. Интерпретатор языка R 4.3.0
4. Пакет `dplyr`
5. файл dns.log
6. файл header.csv

## План

1.  Установить пакет `dplyr`
2.  Импортировать данные DNS
3.  Выполнить задания.

## Ход работы

### Шаг 0

#### Установка пакета `dplyr` с помощью команды `library(dplyr)`

```{r}
library(dplyr)
library(readr)
```

#### Импорт данных

Импорт DNS файла
```{r}
dns2 <- read_delim("dns.log", col_names = FALSE, delim = "\t")
dns1 <- head((dns2), n = nrow(dns2) - 2)
dns1
```


Импорт CSV файла

```{r}
header <- read.csv ("header.csv")
```


#### Добавление пропущенных данных

```{r}
colnames (dns1) <- read.csv ("header.csv", header = FALSE, skip = 1)$V1
```


#### Преобразование данных в нужный формат

```{r}
field <- header [,1]
colnames (dns1) <- field
```

#### Просмотр общей структуры данных с помощью функции `glimpse ()`

```{r}
dns1 %>% glimpse ()
```

### Ответы на вопросы

#### 1. Сколько участников информационного обмена в
сети Доброй Организации?

```{r}
member1 <- unique (dns1$`id.orig_h`)
member2 <- unique (dns1$`id.resp_h`)
member <- union (member1 , member2)
member %>% length ()
```

#### 2.Какое соотношение участников обмена внутри
сети и участников обращений к внешним
ресурсам?

```{r}
ip_gen <- c ("10.", "100.([6-9]|1[0-1][0-9]|12[0-7]).", "172.((1[6-9])|(2[0-9])|(3[0-1])).", "192.168.")
ip_in <- member [grep (paste (ip_gen, collapse = "|"), member)]
count_ip_in <- sum (member %in% ip_in)
count_ip_ex <- length (member) - count_ip_in

mem_ratio <- count_ip_in / count_ip_ex
mem_ratio
```

#### 3. Найдите топ-10 участников сети, проявляющих
наибольшую сетевую активность

```{r}
top_10 <- dns1 %>% group_by (id.orig_h) %>% summarise (activ = n ()) %>% arrange(desc (activ))

top_10 %>% head(10)
```

#### 4. Найдите топ-10 доменов, к которым обращаются
пользователи сети и соответственное количество
обращений

```{r}
top <- dns1 %>% group_by (`query `) %>% summarise (req_count = n ()) %>% arrange (desc (req_count)) 

top %>% head(10)
```

#### 5. Опеределите базовые статистические
характеристики (функция summary() ) интервала
времени между последовательным обращениями к
топ-10 доменам.

```{r}

```

#### 6. Часто вредоносное программное обеспечение
использует DNS канал в качестве канала
управления, периодически отправляя запросы на
подконтрольный злоумышленникам DNS сервер.
По периодическим запросам на один и тот же
домен можно выявить скрытый DNS канал. Есть ли
такие IP адреса в исследуемом датасете?

```{r}

```

### Обогащение данных

#### Определите местоположение (страну, город) и
организацию-провайдера для топ-10 доменов.

```{r}

```
